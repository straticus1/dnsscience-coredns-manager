# DNS Science Toolkit Helm Values
# Default configuration values

# Global settings
global:
  imageRegistry: ""
  imagePullSecrets: []

# API Server configuration
api:
  enabled: true
  replicaCount: 2

  image:
    repository: dnsscience-toolkit
    tag: api
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 8000

  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts:
      - host: dnsscience.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  env:
    DNSSCIENCE_RESOLVER: "coredns"
    DNSSCIENCE_LOG_LEVEL: "INFO"

  # Pod-level settings
  nodeSelector: {}
  tolerations: []
  affinity: {}

  # Health probes
  livenessProbe:
    httpGet:
      path: /api/v1/health/live
      port: http
    initialDelaySeconds: 10
    periodSeconds: 30

  readinessProbe:
    httpGet:
      path: /api/v1/health/ready
      port: http
    initialDelaySeconds: 5
    periodSeconds: 10

# Admin Panel configuration
admin:
  enabled: true
  replicaCount: 1

  image:
    repository: dnsscience-toolkit
    tag: admin
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 8001

  ingress:
    enabled: false
    className: ""
    annotations: {}
    hosts:
      - host: admin.dnsscience.local
        paths:
          - path: /
            pathType: Prefix
    tls: []

  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi

# Kubernetes Operator configuration
operator:
  enabled: false
  replicaCount: 1

  image:
    repository: dnsscience-toolkit
    tag: operator
    pullPolicy: IfNotPresent

  resources:
    limits:
      cpu: 250m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 64Mi

  # RBAC settings
  rbac:
    create: true

  serviceAccount:
    create: true
    name: ""
    annotations: {}

# CoreDNS configuration (for managed deployments)
coredns:
  enabled: false

  # Override existing CoreDNS ConfigMap
  manageConfigMap: false
  configMapName: coredns
  configMapNamespace: kube-system

  # Custom Corefile (if managing ConfigMap)
  corefile: |
    .:53 {
        errors
        health {
            lameduck 5s
        }
        ready
        kubernetes cluster.local in-addr.arpa ip6.arpa {
            pods insecure
            fallthrough in-addr.arpa ip6.arpa
            ttl 30
        }
        prometheus :9153
        forward . /etc/resolv.conf {
            max_concurrent 1000
        }
        cache 30
        loop
        reload
        loadbalance
    }

# Unbound configuration (for managed deployments)
unbound:
  enabled: false

  # Connection settings for external Unbound
  host: ""
  port: 53
  controlPort: 8953

# Compare engine configuration
compare:
  # Source resolver for comparisons
  source:
    type: coredns
    host: ""
    port: 53

  # Target resolver for comparisons
  target:
    type: unbound
    host: ""
    port: 53

# Monitoring configuration
monitoring:
  enabled: false

  # ServiceMonitor for Prometheus Operator
  serviceMonitor:
    enabled: false
    interval: 30s
    scrapeTimeout: 10s
    labels: {}

  # Grafana dashboards
  dashboards:
    enabled: false

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Network Policies
networkPolicy:
  enabled: false
  ingress: []
  egress: []

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

# Pod security context
podSecurityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL
